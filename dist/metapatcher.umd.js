!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("basekits"),require("dom-scripter")):"function"==typeof define&&define.amd?define(["basekits","dom-scripter"],e):(t=t||self).Metapatcher=e(t.Basekits,t.Scripter)}(this,(function(t,e){"use strict";function i(t){this.settings={},this.applySettings(t),this.set("meta","name",{name:"msapplication-config",content:"none"})}return e=e&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e,i.prototype.defaultSettings={structuredData:{enabled:!0},androidChromeIcons:{enabled:!0},msTags:{enabled:!0},safariTags:{enabled:!0},appleTags:{enabled:!0},openGraphTags:{enabled:!0},twitterTags:{enabled:!0},facebookTags:{enabled:!0}},i.prototype.mimeTypesByExtension={svg:"image/svg+xml",png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg",ico:"image/x-icon",gif:"image/gif",webp:"image/webp",bmp:"image/bmp"},i.prototype.prioritizeMethods=["preload","prefetch","preconnect","dns-prefetch"],i.prototype.validAndroidChromeIconSizes=["72x72","96x96","128x128","144x144","152x152","192x192","384x384","512x512"],i.prototype.validAppleTouchIconSizes=["120x120","180x180","152x152","167x167","1024x1024"],i.prototype.validMSTileIconSizes=["70x70","150x150","310x150","310x310"],i.prototype.mstilesNamingMap={"70x70":"msapplication-square70x70logo","150x150":"msapplication-square150x150logo","310x310":"msapplication-square310x310logo","310x150":"msapplication-wide310x150logo"},i.prototype.reImageSizeFromStr=/[0-9]{2,3}x[0-9]{2,3}/g,i.prototype.setFavicon=function(e){var i=this.findMimeType(e);if(!t.validationkit.isEmpty(i))return this.set("link","rel",{rel:"shortcut icon",href:e,type:i})},i.prototype.setProjectMeta=function(i){if(!t.validationkit.isEmpty(i))return t.validationkit.isNotEmpty(i.name)&&(this.settings.msTags.enabled&&this.set("meta","name",{name:"application-name",content:i.name}),this.settings.safariTags.enabled&&this.setSafariMobileWebApp({name:i.name}),this.settings.openGraphTags.enabled&&this.set("meta","property",{property:"og:site_name",content:i.name})),t.validationkit.isNotEmpty(i.url)&&this.settings.msTags.enabled&&this.set("meta","name",{name:"msapplication-starturl",content:i.url}),t.validationkit.isNotEmpty(i.logo)&&this.settings.structuredData.enabled&&e.injectJSONLD({"@type":"Organization",logo:i.logo,url:i.url},{"data-mptype":"sdorg"}),t.validationkit.isNotEmpty(i.primaryColor)&&this.set("meta","name",{name:"theme-color",content:i.primaryColor}),t.validationkit.isNotEmpty(i.backgroundColor)&&this.settings.msTags.enabled&&this.set("meta","name",{name:"msapplication-TileColor",content:i.backgroundColor}),this},i.prototype.robots=function(t){return this.set("meta","name",{name:"robots",content:t})},i.prototype.prioritize=function(t,e){if(-1!==this.prioritizeMethods.indexOf(e))return this.set("meta",void 0,{name:e,content:t})},i.prototype.removeAllPrioritizations=function(){for(var e=0;e<this.prioritizeMethods.length;e++){var i=this.prioritizeMethods[e],n=document.querySelectorAll('meta[name="'+i+'"]');if(t.validationkit.isNotEmpty(n))for(var o=0;o<n.length;o++)n[o].parentNode.removeChild(n[o])}return this},i.prototype.setIcons=function(t){var e=this,i=Object.values(e.mimeTypesByExtension);return t.map((function(t){var n=e.findMimeType(t),o=t.match(e.reImageSizeFromStr);if(o&&o.length>0&&n&&-1!==i.indexOf(n)){var a=o[0];-1!==e.validAndroidChromeIconSizes.indexOf(a)&&e.settings.androidChromeIcons.enabled&&e.set("link",void 0,{rel:"icon",href:t,sizes:a,type:n}),-1!==e.validAppleTouchIconSizes.indexOf(a)&&e.settings.appleTags.enabled&&e.set("link",void 0,{rel:"apple-touch-icon",href:t,sizes:a}),-1!==e.validMSTileIconSizes.indexOf(a)&&e.settings.msTags.enabled&&e.set("meta",void 0,{name:e.mstilesNamingMap[a],content:t})}})),e},i.prototype.setCanonical=function(t){return this.set("link",void 0,{rel:"canonical",href:t})},i.prototype.removeAllCanonicals=function(){var e=document.querySelectorAll('link[rel="canonical"]');if(t.validationkit.isNotEmpty(e))for(var i=0;i<e.length;i++)e[i].parentNode.removeChild(e[i]);return this},i.prototype.setLocalVersion=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.set("link",void 0,{rel:"alternate",href:e,hreflang:t}),this.settings.openGraphTags.enabled){var n=i?"":":alternate";this.set("meta",void 0,{property:"og:locale"+n,content:t})}return this},i.prototype.removeAllLocalVersions=function(){var e=document.querySelectorAll('link[rel="alternate"]');if(t.validationkit.isNotEmpty(e))for(var i=0;i<e.length;i++)elems2[i].parentNode.removeChild(elems2[i]);if(this.settings.openGraphTags.enabled){var n=document.querySelectorAll('meta[property="og:locale:alternate"]');if(t.validationkit.isNotEmpty(n))for(var o=0;o<n.length;o++)n[o].parentNode.removeChild(n[o]);var a=document.querySelector('meta[property="og:locale"]');t.validationkit.isNotEmpty(a)&&a.parentNode.removeChild(a)}return this},i.prototype.setPageMeta=function(e){if(t.validationkit.isEmpty(e))return this;if(t.validationkit.isNotEmpty(e.title)&&(document.title=e.title,this.settings.openGraphTags.enabled&&this.set("meta","property",{property:"og:title",content:e.title}),this.settings.twitterTags.enabled&&this.set("meta","name",{name:"twitter:title",content:e.title})),t.validationkit.isNotEmpty(e.description)&&(this.set("meta","name",{name:"description",content:e.description}),this.settings.openGraphTags.enabled&&this.set("meta","property",{property:"og:description",content:e.description}),this.settings.twitterTags.enabled&&this.set("meta","name",{name:"twitter:description",content:e.description})),t.validationkit.isNotEmpty(e.url)&&this.settings.openGraphTags.enabled&&this.set("meta","property",{property:"og:url",content:e.url}),t.validationkit.isNotEmpty(e.image)){var i=this.formatImageInput(e.image);this.settings.openGraphTags.enabled&&(this.set("meta","property",{property:"og:image",content:i.url}),t.validationkit.isNotEmpty(i.width)&&this.set("meta","property",{property:"og:image:width",content:i.width}),t.validationkit.isNotEmpty(i.height)&&this.set("meta","property",{property:"og:image:height",content:i.height})),this.settings.twitterTags.enabled&&this.set("meta","name",{name:"twitter:image",content:i.url})}return t.validationkit.isNotEmpty(e.locale)&&(document.querySelector("html").setAttribute("lang",e.locale),this.settings.openGraphTags.enabled&&this.set("meta","property",{property:"og:locale",content:e.locale.replace("-","_")})),this},i.prototype.setSafariMobileWebApp=function(e){return this.settings.appleTags.enabled?(this.set("meta","name",{name:"apple-mobile-web-app-capable",content:"yes"}),t.validationkit.isNotEmpty(e.name)&&this.set("meta","name",{name:"apple-mobile-web-app-title",content:e.name}),t.validationkit.isNotEmpty(e.statusBarStyle)&&this.set("meta","name",{name:"apple-mobile-web-app-status-bar-style",content:e.statusBarStyle}),this):this},i.prototype.setSafariPinnedTab=function(t,e){return this.set("link","rel",{rel:"mask-icon",href:t,color:e||"black"})},i.prototype.setFacebookMeta=function(e){return t.validationkit.isNotEmpty(e.appID)&&this.set("meta","property",{property:"fb:app_id",content:e.appID}),this},i.prototype.setTwitterMeta=function(e){if(!this.settings.twitterTags.enabled)return this;t.validationkit.isNotEmpty(e.card)&&this.set("meta","name",{name:"twitter:card",content:e.card}),t.validationkit.isNotEmpty(e.site)&&this.set("meta","name",{name:"twitter:site",content:e.site}),t.validationkit.isNotEmpty(e.creator)&&this.set("meta","name",{name:"twitter:creator",content:e.creator})},i.prototype.breadcrumb=function(t){if(!this.settings.structuredData.enabled)return this;var i={"@type":"BreadcrumbList",itemListElement:t.map((function(t,e){return{"@type":"ListItem",position:e+1,name:t.title,item:t.url}}))};return e.injectJSONLD(i,{"data-mptype":"sdb"}),this},i.prototype.formatImageInput=function(e){return t.typekit.isString(e)?{url:e}:t.typekit.isObject(e)?{url:e.url,width:e.width,height:e.height}:{}},i.prototype.findMimeType=function(e){var i=e.lastIndexOf(".");if(!(i<1)){var n=e.slice(i+1);if(!t.validationkit.isEmpty(n))return t.objectkit.getProp(this.mimeTypesByExtension,n,void 0)}},i.prototype.set=function(e,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(t.validationkit.isNotEmpty(i)){var o=this.hasElement(e+"["+i+'="'+n[i]+'"]');o&&o.parentNode.removeChild(o)}var a=this.createElement(e,n);return this.patch(a),a},i.prototype.hasElement=function(t){return document.querySelector(t)},i.prototype.createElement=function(e,i){var n=document.createElement(e);return t.typekit.isObject(i)&&Object.keys(i).map((function(t){return n.setAttribute(t,i[t])})),n},i.prototype.patch=function(t){document.getElementsByTagName("head")[0].insertBefore(t,null)},i.prototype.applySettings=function(e){var i=this.defaultSettings;this.settings=Object.keys(this.defaultSettings).reduce((function(n,o){return n[o]=t.objectkit.getProp(e,o,t.objectkit.getProp(i,o,{})),n}),{})},i}));
