{"version":3,"file":"index.js","sources":["../../../src/index.js"],"sourcesContent":["import {DomScripter} from 'dom-scripter'\n\nconst scripter = new DomScripter()\n\nfunction Metapatcher() {\n  this.isDomAvailable = typeof document !== 'undefined'\n  this.headData = []\n\n  this.configure()\n\n  // prevent ms browsers to request browserconfig.xml file on openning\n  this.set('meta', 'name', {name: 'msapplication-config', content: 'none'})\n}\n\nMetapatcher.prototype.defaultSettings = {\n  structuredData: {enabled: true},\n  androidChromeIcons: {enabled: true},\n  msTags: {enabled: true},\n  safariTags: {enabled: true},\n  appleTags: {enabled: true},\n  openGraphTags: {enabled: true},\n  twitterTags: {enabled: true},\n  facebookTags: {enabled: true}\n}\nMetapatcher.prototype.mimeTypesByExtension = {\n  'svg': 'image/svg+xml',\n  'png': 'image/png',\n  'jpg': 'image/jpeg',\n  'jpeg': 'image/jpeg',\n  'ico': 'image/x-icon',\n  'gif': 'image/gif',\n  'webp': 'image/webp',\n  'bmp': 'image/bmp'\n}\nMetapatcher.prototype.prioritizeMethods = ['preload', 'prefetch', 'preconnect', 'dns-prefetch']\nMetapatcher.prototype.validAndroidChromeIconSizes = [\n  '72x72', '96x96', '128x128', '144x144', '152x152', '192x192', '384x384', '512x512'\n]\nMetapatcher.prototype.validAppleTouchIconSizes = [\n  '120x120', '180x180', '152x152', '167x167', '1024x1024'\n]\nMetapatcher.prototype.validMSTileIconSizes = [\n  '70x70', '150x150', '310x150', '310x310'\n]\nMetapatcher.prototype.mstilesNamingMap = {\n  '70x70': 'msapplication-square70x70logo',\n  '150x150': 'msapplication-square150x150logo',\n  '310x310': 'msapplication-square310x310logo',\n  '310x150': 'msapplication-wide310x150logo'\n}\nMetapatcher.prototype.reImageSizeFromStr = /[0-9]{2,3}x[0-9]{2,3}/g\n\nMetapatcher.prototype.setFavicon = function setFavicon(path) {\n  const mime = this.findMimeType(path)\n  if (!mime) return undefined\n  return this.set('link', 'rel', {rel: 'shortcut icon', href: path, type: mime})\n}\n\nMetapatcher.prototype.setProjectMeta = function setProjectMeta(obj) {\n  if (!this.isObject(obj)) return undefined\n\n  if (obj.name) {\n    if (this.settings.msTags.enabled) {\n      this.set('meta', 'name', {name: 'application-name', content: obj.name})\n    }\n    if (this.settings.safariTags.enabled) {\n      this.setSafariMobileWebApp({name: obj.name})\n    }\n    if (this.settings.openGraphTags.enabled) {\n      this.set('meta', 'property', {property: 'og:site_name', content: obj.name})\n    }\n  }\n\n  if (obj.url) {\n    if (this.settings.msTags.enabled) {\n      this.set('meta', 'name', {name: 'msapplication-starturl', content: obj.url})\n    }\n  }\n\n  if (obj.logo) {\n    if (this.settings.structuredData.enabled) {\n      const logoJsonLdId = 'metapatcher-project-meta-organization'\n      const logoJsonLd = {\n        '@type': 'Organization',\n        logo: obj.logo,\n        url: obj.url\n      }\n      if (!this.isDomAvailable) {\n        this.headData.push(`<script type=\"application/ld+json\" id=\"${logoJsonLdId}\">${JSON.stringify(logoJsonLd)}</script>`)\n      }\n      else {\n        scripter.injectjsonld(logoJsonLd, {location: 'headEnd', id: logoJsonLdId})\n      }\n    }\n  }\n\n  if (obj.primaryColor) {\n    this.set('meta', 'name', {name: 'theme-color', content: obj.primaryColor})\n  }\n\n  if (obj.backgroundColor) {\n    if (this.settings.msTags.enabled) {\n      this.set('meta', 'name', {name: 'msapplication-TileColor', content: obj.backgroundColor})\n    }\n  }\n\n  return this\n}\n\nMetapatcher.prototype.robots = function robots(directives) {\n  return this.set('meta', 'name', {name: 'robots', content: directives})\n}\n\nMetapatcher.prototype.prioritize = function prioritize(url, method) {\n  if (this.prioritizeMethods.indexOf(method) === -1) return undefined\n  return this.set('meta', undefined, {name: method, content: url})\n}\n\nMetapatcher.prototype.removeAllPrioritizations = function removeAllPrioritizations() {\n  if (!this.isDomAvailable) return this;\n\n  for (var i = 0; i < this.prioritizeMethods.length; i++) {\n    const method = this.prioritizeMethods[i]\n    const elems = document.querySelectorAll('meta[name=\"' + method + '\"]')\n    if (elems && elems.length > 0) {\n      for (let i = 0; i < elems.length; i++) {\n        elems[i].parentNode.removeChild(elems[i])\n      }\n    }\n  }\n\n  return this\n}\n\nMetapatcher.prototype.setIcons = function setIcons(list) {\n  const self = this\n  const validTypes = Object.values(self.mimeTypesByExtension)\n\n  list.map(function(url) {\n    const type = self.findMimeType(url)\n    const sizeMatches = url.match(self.reImageSizeFromStr)\n\n    if (sizeMatches && sizeMatches.length > 0 && type && validTypes.indexOf(type) !== -1) {\n      const size = sizeMatches[0]\n      // android chrome icons\n      if (self.validAndroidChromeIconSizes.indexOf(size) !== -1 &&\n      self.settings.androidChromeIcons.enabled) {\n        self.set('link', undefined, {rel: 'icon', href: url, sizes: size, type: type})\n      }\n      // apple touch icons\n      if (self.validAppleTouchIconSizes.indexOf(size) !== -1 &&\n      self.settings.appleTags.enabled) {\n        self.set('link', undefined, {rel: 'apple-touch-icon', href: url, sizes: size})\n      }\n      // mstile icons\n      if (self.validMSTileIconSizes.indexOf(size) !== -1 &&\n      self.settings.msTags.enabled) {\n        self.set('meta', undefined, {name: self.mstilesNamingMap[size], content: url})\n      }\n    }\n  })\n\n  return self\n}\n\n// set canonicals one by one\nMetapatcher.prototype.setCanonical = function setCanonical(url) {\n  return this.set('link', undefined, {rel: 'canonical', href: url})\n}\n// and remove all at once\nMetapatcher.prototype.removeAllCanonicals = function removeAllCanonicals() {\n  if (!this.isDomAvailable) return this;\n\n  const elems = document.querySelectorAll('link[rel=\"canonical\"]')\n  if (elems && elems.length > 0) {\n    for (let i = 0; i < elems.length; i++) {\n      elems[i].parentNode.removeChild(elems[i])\n    }\n  }\n\n  return this\n}\n\n// set local versions one by one\nMetapatcher.prototype.setLocalVersion = function setLocalVersion(locale, url, isActiveLocale = false) {\n  this.set('link', undefined, {rel: 'alternate', href: url, hreflang: locale})\n\n  if (this.settings.openGraphTags.enabled) {\n    const suffix = isActiveLocale ? '' : ':alternate'\n    this.set('meta', undefined, {property: 'og:locale' + suffix, content: locale})\n  }\n\n  return this\n}\n// and remove all at once\nMetapatcher.prototype.removeAllLocalVersions = function removeAllLocalVersions() {\n  if (!this.isDomAvailable) return this;\n\n  const elems = document.querySelectorAll('link[rel=\"alternate\"]')\n  if (elems && elems.length > 0) {\n    for (let i = 0; i < elems.length; i++) {\n      elems[i].parentNode.removeChild(elems[i])\n    }\n  }\n\n  if (this.settings.openGraphTags.enabled) {\n    const elems2 = document.querySelectorAll('meta[property=\"og:locale:alternate\"]')\n    if (elems2 && elems2.length > 0) {\n      for (let j = 0; j < elems2.length; j++) {\n        elems2[j].parentNode.removeChild(elems2[j])\n      }\n    }\n\n    const elem = document.querySelector('meta[property=\"og:locale\"]')\n    if (elem) {\n      elem.parentNode.removeChild(elem)\n    }\n  }\n\n  return this\n}\n\nMetapatcher.prototype.setPageTitle = function setPageTitle(value) {\n  if (!this.isDomAvailable) this.headData.push(`<title>${value}</title>`)\n  else document.title = value\n}\n\nMetapatcher.prototype.setPageMeta = function setPageMeta(obj) {\n  if (!this.isObject(obj)) return this\n\n  if (obj.title) {\n    this.setPageTitle(obj.title)\n\n    if (this.settings.openGraphTags.enabled) {\n      this.set('meta', 'property', {property: 'og:title', content: obj.title})\n    }\n\n    if (this.settings.twitterTags.enabled) {\n      this.set('meta', 'name', {name: 'twitter:title', content: obj.title})\n    }\n  }\n\n  if (obj.description) {\n    this.set('meta', 'name', {name: 'description', content: obj.description})\n\n    if (this.settings.openGraphTags.enabled) {\n      this.set('meta', 'property', {property: 'og:description', content: obj.description})\n    }\n\n    if (this.settings.twitterTags.enabled) {\n      this.set('meta', 'name', {name: 'twitter:description', content: obj.description})\n    }\n  }\n\n  if (obj.url) {\n    if (this.settings.openGraphTags.enabled) {\n      this.set('meta', 'property', {property: 'og:url', content: obj.url})\n    }\n  }\n\n  if (obj.image) {\n    const imgobj = this.formatImageInput(obj.image)\n    if (this.settings.openGraphTags.enabled) {\n      this.set('meta', 'property', {property: 'og:image', content: imgobj.url})\n\n      if (imgobj.width) {\n        this.set('meta', 'property', {property: 'og:image:width', content: imgobj.width})\n      }\n\n      if (imgobj.height) {\n        this.set('meta', 'property', {property: 'og:image:height', content: imgobj.height})\n      }\n    }\n\n    if (this.settings.twitterTags.enabled) {\n      this.set('meta', 'name', {name: 'twitter:image', content: imgobj.url})\n    }\n  }\n\n  if (obj.locale) {\n    if (!this.isDomAvailable) {\n      document.querySelector('html').setAttribute('lang', obj.locale)\n    }\n\n    if (this.settings.openGraphTags.enabled) {\n      this.set('meta', 'property', {property: 'og:locale', content: obj.locale.replace('-', '_')})\n    }\n  }\n\n  if (obj.localVersions) {\n    Object\n      .keys(obj.localVersions)\n      .map(\n        l => this.setLocalVersion(\n          l, obj.localVersions[l], obj.locale && obj.locale == l\n        )\n      )\n  }\n\n  if (obj.canonicals) {\n    obj.canonicals.map(u => this.setCanonical(u))\n  }\n\n  return this\n}\n\nMetapatcher.prototype.setSafariMobileWebApp = function setSafariMobileWebApp(obj) {\n  if (!this.settings.appleTags.enabled) return this\n\n  this.set('meta', 'name', {name: 'apple-mobile-web-app-capable', content: 'yes'})\n\n  if (obj.name) {\n    this.set('meta', 'name', {name: 'apple-mobile-web-app-title', content: obj.name})\n  }\n\n  if (obj.statusBarStyle) {\n    this.set('meta', 'name', {name: 'apple-mobile-web-app-status-bar-style', content: obj.statusBarStyle})\n  }\n\n  return this\n}\n\nMetapatcher.prototype.setSafariPinnedTab = function setSafariPinnedTab(url, color) {\n  return this.set('link', 'rel', {rel: 'mask-icon', href: url, color: color || 'black'})\n}\n\nMetapatcher.prototype.setFacebookMeta = function setFacebookMeta(obj) {\n  if (obj.appID) {\n    this.set('meta', 'property', {property: 'fb:app_id', content: obj.appID})\n  }\n  return this\n}\n\nMetapatcher.prototype.setTwitterMeta = function setTwitterMeta(obj) {\n  if (!this.settings.twitterTags.enabled) return this\n\n  if (obj.card)\n    this.set('meta', 'name', {name: 'twitter:card', content: obj.card})\n\n  if (obj.site)\n    this.set('meta', 'name', {name: 'twitter:site', content: obj.site})\n\n  if (obj.creator)\n    this.set('meta', 'name', {name: 'twitter:creator', content: obj.creator})\n}\n\nMetapatcher.prototype.breadcrumb = function breadcrumb(data, attrs = {}) {\n  if (!this.settings.structuredData.enabled) return this\n\n  const o = {\n    '@type': 'BreadcrumbList',\n    'itemListElement': data.map(function(obj, index) {\n      return {\n        '@type': 'ListItem',\n        'position': index + 1,\n        'name': obj.title,\n        'item': obj.url\n      }\n    })\n  }\n\n  if (!this.isDomAvailable) {\n    this.headData.push(`<script type=\"application/ld+json\"${this.isObject(attrs)\n      ? ' ' + Object.keys(attrs).map(attr => `${attr}=\"${attrs[attr]}\"`).join(' ')\n      : ''}>${JSON.stringify(o)}</script>`)\n  }\n  else {\n    scripter.injectjsonld(o, {location: 'headEnd', attrs: attrs})\n  }\n\n  return this\n}\n\nMetapatcher.prototype.formatImageInput = function formatImageInput(input) {\n  if (typeof input == 'string') return {\n    url: input\n  }\n  else if (this.isObject(input)) return {\n    url: input.url,\n    width: input.width,\n    height: input.height\n  }\n  else return {}\n}\n\nMetapatcher.prototype.findMimeType = function findMimeType(path) {\n  const lastind = path.lastIndexOf('.')\n  if (lastind < 1) return undefined\n\n  const ext = path.slice(lastind + 1)\n  if (!ext) return undefined\n\n  return this.mimeTypesByExtension[ext] || undefined\n}\n\nMetapatcher.prototype.set = function set(tag, id, attrs = {}) {\n  if (!this.isDomAvailable) {\n    const html = `<${tag}${id ? ' id=\"' + id + '\"' : ''}${this.isObject(attrs)\n      ? ' ' + Object.keys(attrs).map(attr => `${attr}=\"${attrs[attr]}\"`).join(' ')\n      : ''}>`\n    this.headData.push(html)\n    return html;\n  }\n\n  if (id) {\n    const alreadyExist = this.hasElement(tag + '[' + id + '=\"' + attrs[id] + '\"]')\n    if (alreadyExist) alreadyExist.parentNode.removeChild(alreadyExist)\n  }\n\n  const elem = this.createElement(tag, attrs)\n\n  this.patch(elem)\n\n  return elem\n}\n\nMetapatcher.prototype.hasElement = function hasElement(query) {\n  return document.querySelector(query)\n}\n\nMetapatcher.prototype.createElement = function createElement(tag, attrs) {\n  const elem = document.createElement(tag)\n  if (this.isObject(attrs)) {\n    Object.keys(attrs).map(attr => elem.setAttribute(attr, attrs[attr]))\n  }\n  return elem\n}\n\nMetapatcher.prototype.patch = function patch(elem) {\n  document.getElementsByTagName('head')[0].insertBefore(elem, null)\n}\n\nMetapatcher.prototype.dump = function dump() {\n  const data = this.headData.join(\"\\n\")\n  this.headData = []\n  return data\n}\n\nMetapatcher.prototype.configure = function configure(userSettings = {}) {\n  const defaultSettings = this.defaultSettings\n  this.settings = Object\n    .keys(this.defaultSettings)\n    .reduce(function(memo, name) {\n      memo[name] = userSettings[name] || (defaultSettings[name] || {})\n      return memo\n    }, {})\n}\n\nMetapatcher.prototype.isObject = function isObject(v) {\n  return Object.prototype.toString.call(v) === '[object Object]'\n}\n\nexport default new Metapatcher()\n"],"names":["scripter","DomScripter","Metapatcher","isDomAvailable","document","headData","configure","set","name","content","prototype","defaultSettings","structuredData","enabled","androidChromeIcons","msTags","safariTags","appleTags","openGraphTags","twitterTags","facebookTags","mimeTypesByExtension","prioritizeMethods","validAndroidChromeIconSizes","validAppleTouchIconSizes","validMSTileIconSizes","mstilesNamingMap","reImageSizeFromStr","setFavicon","path","mime","findMimeType","undefined","rel","href","type","setProjectMeta","obj","isObject","settings","setSafariMobileWebApp","property","url","logo","logoJsonLdId","logoJsonLd","push","_JSON$stringify","injectjsonld","location","id","primaryColor","backgroundColor","robots","directives","prioritize","method","_indexOfInstanceProperty","removeAllPrioritizations","i","length","elems","querySelectorAll","parentNode","removeChild","setIcons","list","self","validTypes","_Object$values","_mapInstanceProperty","sizeMatches","match","size","sizes","setCanonical","removeAllCanonicals","setLocalVersion","locale","isActiveLocale","hreflang","suffix","removeAllLocalVersions","elems2","j","elem","querySelector","setPageTitle","value","title","setPageMeta","description","image","imgobj","formatImageInput","width","height","setAttribute","replace","localVersions","_Object$keys","l","canonicals","u","statusBarStyle","setSafariPinnedTab","color","setFacebookMeta","appID","setTwitterMeta","card","site","creator","breadcrumb","data","attrs","o","index","_concatInstanceProperty","attr","join","input","lastind","_lastIndexOfInstanceProperty","ext","_sliceInstanceProperty","tag","html","alreadyExist","hasElement","createElement","patch","query","getElementsByTagName","insertBefore","dump","userSettings","_reduceInstanceProperty","memo","v","Object","toString","call"],"mappings":"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"}