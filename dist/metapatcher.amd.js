define(["basekits","dom-scripter"],(function(t,e){"use strict";function i(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var n=i(e);function o(){this.configure(),this.set("meta","name",{name:"msapplication-config",content:"none"})}return o.prototype.defaultSettings={structuredData:{enabled:!0},androidChromeIcons:{enabled:!0},msTags:{enabled:!0},safariTags:{enabled:!0},appleTags:{enabled:!0},openGraphTags:{enabled:!0},twitterTags:{enabled:!0},facebookTags:{enabled:!0}},o.prototype.mimeTypesByExtension={svg:"image/svg+xml",png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg",ico:"image/x-icon",gif:"image/gif",webp:"image/webp",bmp:"image/bmp"},o.prototype.prioritizeMethods=["preload","prefetch","preconnect","dns-prefetch"],o.prototype.validAndroidChromeIconSizes=["72x72","96x96","128x128","144x144","152x152","192x192","384x384","512x512"],o.prototype.validAppleTouchIconSizes=["120x120","180x180","152x152","167x167","1024x1024"],o.prototype.validMSTileIconSizes=["70x70","150x150","310x150","310x310"],o.prototype.mstilesNamingMap={"70x70":"msapplication-square70x70logo","150x150":"msapplication-square150x150logo","310x310":"msapplication-square310x310logo","310x150":"msapplication-wide310x150logo"},o.prototype.reImageSizeFromStr=/[0-9]{2,3}x[0-9]{2,3}/g,o.prototype.setFavicon=function(e){var i=this.findMimeType(e);if(!t.validationkit.isEmpty(i))return this.set("link","rel",{rel:"shortcut icon",href:e,type:i})},o.prototype.setProjectMeta=function(e){if(!t.validationkit.isEmpty(e))return t.validationkit.isNotEmpty(e.name)&&(this.settings.msTags.enabled&&this.set("meta","name",{name:"application-name",content:e.name}),this.settings.safariTags.enabled&&this.setSafariMobileWebApp({name:e.name}),this.settings.openGraphTags.enabled&&this.set("meta","property",{property:"og:site_name",content:e.name})),t.validationkit.isNotEmpty(e.url)&&this.settings.msTags.enabled&&this.set("meta","name",{name:"msapplication-starturl",content:e.url}),t.validationkit.isNotEmpty(e.logo)&&this.settings.structuredData.enabled&&n.default.injectJSONLD({"@type":"Organization",logo:e.logo,url:e.url},{"data-mptype":"sdorg"}),t.validationkit.isNotEmpty(e.primaryColor)&&this.set("meta","name",{name:"theme-color",content:e.primaryColor}),t.validationkit.isNotEmpty(e.backgroundColor)&&this.settings.msTags.enabled&&this.set("meta","name",{name:"msapplication-TileColor",content:e.backgroundColor}),this},o.prototype.robots=function(t){return this.set("meta","name",{name:"robots",content:t})},o.prototype.prioritize=function(t,e){if(-1!==this.prioritizeMethods.indexOf(e))return this.set("meta",void 0,{name:e,content:t})},o.prototype.removeAllPrioritizations=function(){for(var e=0;e<this.prioritizeMethods.length;e++){var i=this.prioritizeMethods[e],n=document.querySelectorAll('meta[name="'+i+'"]');if(t.validationkit.isNotEmpty(n))for(var o=0;o<n.length;o++)n[o].parentNode.removeChild(n[o])}return this},o.prototype.setIcons=function(t){var e=this,i=Object.values(e.mimeTypesByExtension);return t.map((function(t){var n=e.findMimeType(t),o=t.match(e.reImageSizeFromStr);if(o&&o.length>0&&n&&-1!==i.indexOf(n)){var a=o[0];-1!==e.validAndroidChromeIconSizes.indexOf(a)&&e.settings.androidChromeIcons.enabled&&e.set("link",void 0,{rel:"icon",href:t,sizes:a,type:n}),-1!==e.validAppleTouchIconSizes.indexOf(a)&&e.settings.appleTags.enabled&&e.set("link",void 0,{rel:"apple-touch-icon",href:t,sizes:a}),-1!==e.validMSTileIconSizes.indexOf(a)&&e.settings.msTags.enabled&&e.set("meta",void 0,{name:e.mstilesNamingMap[a],content:t})}})),e},o.prototype.setCanonical=function(t){return this.set("link",void 0,{rel:"canonical",href:t})},o.prototype.removeAllCanonicals=function(){var e=document.querySelectorAll('link[rel="canonical"]');if(t.validationkit.isNotEmpty(e))for(var i=0;i<e.length;i++)e[i].parentNode.removeChild(e[i]);return this},o.prototype.setLocalVersion=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.set("link",void 0,{rel:"alternate",href:e,hreflang:t}),this.settings.openGraphTags.enabled){var n=i?"":":alternate";this.set("meta",void 0,{property:"og:locale"+n,content:t})}return this},o.prototype.removeAllLocalVersions=function(){var e=document.querySelectorAll('link[rel="alternate"]');if(t.validationkit.isNotEmpty(e))for(var i=0;i<e.length;i++)elems2[i].parentNode.removeChild(elems2[i]);if(this.settings.openGraphTags.enabled){var n=document.querySelectorAll('meta[property="og:locale:alternate"]');if(t.validationkit.isNotEmpty(n))for(var o=0;o<n.length;o++)n[o].parentNode.removeChild(n[o]);var a=document.querySelector('meta[property="og:locale"]');t.validationkit.isNotEmpty(a)&&a.parentNode.removeChild(a)}return this},o.prototype.setPageMeta=function(e){var i=this;if(t.validationkit.isEmpty(e))return this;if(t.validationkit.isNotEmpty(e.title)&&(document.title=e.title,this.settings.openGraphTags.enabled&&this.set("meta","property",{property:"og:title",content:e.title}),this.settings.twitterTags.enabled&&this.set("meta","name",{name:"twitter:title",content:e.title})),t.validationkit.isNotEmpty(e.description)&&(this.set("meta","name",{name:"description",content:e.description}),this.settings.openGraphTags.enabled&&this.set("meta","property",{property:"og:description",content:e.description}),this.settings.twitterTags.enabled&&this.set("meta","name",{name:"twitter:description",content:e.description})),t.validationkit.isNotEmpty(e.url)&&this.settings.openGraphTags.enabled&&this.set("meta","property",{property:"og:url",content:e.url}),t.validationkit.isNotEmpty(e.image)){var n=this.formatImageInput(e.image);this.settings.openGraphTags.enabled&&(this.set("meta","property",{property:"og:image",content:n.url}),t.validationkit.isNotEmpty(n.width)&&this.set("meta","property",{property:"og:image:width",content:n.width}),t.validationkit.isNotEmpty(n.height)&&this.set("meta","property",{property:"og:image:height",content:n.height})),this.settings.twitterTags.enabled&&this.set("meta","name",{name:"twitter:image",content:n.url})}return t.validationkit.isNotEmpty(e.locale)&&(document.querySelector("html").setAttribute("lang",e.locale),this.settings.openGraphTags.enabled&&this.set("meta","property",{property:"og:locale",content:e.locale.replace("-","_")})),t.validationkit.isNotEmpty(e.localVersions)&&Object.keys(e.localVersions).map((function(t){return i.setLocalVersion(t,e.localVersions[t])})),t.validationkit.isNotEmpty(e.canonicals)&&e.canonicals.map((function(t){return i.setCanonical(t)})),this},o.prototype.setSafariMobileWebApp=function(e){return this.settings.appleTags.enabled?(this.set("meta","name",{name:"apple-mobile-web-app-capable",content:"yes"}),t.validationkit.isNotEmpty(e.name)&&this.set("meta","name",{name:"apple-mobile-web-app-title",content:e.name}),t.validationkit.isNotEmpty(e.statusBarStyle)&&this.set("meta","name",{name:"apple-mobile-web-app-status-bar-style",content:e.statusBarStyle}),this):this},o.prototype.setSafariPinnedTab=function(t,e){return this.set("link","rel",{rel:"mask-icon",href:t,color:e||"black"})},o.prototype.setFacebookMeta=function(e){return t.validationkit.isNotEmpty(e.appID)&&this.set("meta","property",{property:"fb:app_id",content:e.appID}),this},o.prototype.setTwitterMeta=function(e){if(!this.settings.twitterTags.enabled)return this;t.validationkit.isNotEmpty(e.card)&&this.set("meta","name",{name:"twitter:card",content:e.card}),t.validationkit.isNotEmpty(e.site)&&this.set("meta","name",{name:"twitter:site",content:e.site}),t.validationkit.isNotEmpty(e.creator)&&this.set("meta","name",{name:"twitter:creator",content:e.creator})},o.prototype.breadcrumb=function(t){if(!this.settings.structuredData.enabled)return this;var e={"@type":"BreadcrumbList",itemListElement:t.map((function(t,e){return{"@type":"ListItem",position:e+1,name:t.title,item:t.url}}))};return n.default.injectJSONLD(e,{"data-mptype":"sdb"}),this},o.prototype.formatImageInput=function(e){return t.typekit.isString(e)?{url:e}:t.typekit.isObject(e)?{url:e.url,width:e.width,height:e.height}:{}},o.prototype.findMimeType=function(e){var i=e.lastIndexOf(".");if(!(i<1)){var n=e.slice(i+1);if(!t.validationkit.isEmpty(n))return t.objectkit.getProp(this.mimeTypesByExtension,n,void 0)}},o.prototype.set=function(e,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(t.validationkit.isNotEmpty(i)){var o=this.hasElement(e+"["+i+'="'+n[i]+'"]');o&&o.parentNode.removeChild(o)}var a=this.createElement(e,n);return this.patch(a),a},o.prototype.hasElement=function(t){return document.querySelector(t)},o.prototype.createElement=function(e,i){var n=document.createElement(e);return t.typekit.isObject(i)&&Object.keys(i).map((function(t){return n.setAttribute(t,i[t])})),n},o.prototype.patch=function(t){document.getElementsByTagName("head")[0].insertBefore(t,null)},o.prototype.configure=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=this.defaultSettings;this.settings=Object.keys(this.defaultSettings).reduce((function(n,o){return n[o]=t.objectkit.getProp(e,o,t.objectkit.getProp(i,o,{})),n}),{})},new o}));
